[vscode marketplace](https://marketplace.visualstudio.com/items?itemName=yuuyu.vscode-qiitaapi)

# vscode-qiitaapi README

vscodeからqiitaに投稿することができる拡張機能です。

現在は、markdown(.md)、orgmode(.org)、html(.html)の３種類のファイルから投稿することが可能です。

<br>

# コマンド一覧

コマンドパレットから、qiitaに記事を投稿することができます。

現在使用できるコマンドは以下の通りです。

|コマンド名|コマンド内容|
|-|-|
| qiitaに投稿する | qiitaに投稿、もしくは記事の更新を行います。 |
| qiita テンプレートを付与する | 現在のアクティブファイルに、投稿に関する情報を記述するテンプレートを付与します。 |
| qiita 記事のurlを取得する | mdファイルに設定されているqiita テンプレートを元に記事のurlを取得し、クリップボードに貼り付けます。urlはurl単体と、markdownに直接貼り付けることができる２種類が取得できます。 |
| qiita 画像をアップロードする | mdファイルに存在する画像埋め込み`![text](url)`を抽出し、qiitaにまとめて画像をアップロードするサポートを行います。(下に詳細あり) |
---

<br>

# qiita テンプレート

qiitaに投稿するための付加情報として、ファイルの先頭に「qiita テンプレート」を用意する必要があります。

qiita テンプレートは「スラッシュとアスタリスク10個からなるライン」もしくは「ハイフン3つで構成されたライン」のいずれかで囲まれ、以下の情報を保持します。

|情報名|必要度|情報内容|
|-|-|-|
|ID|-|qiitaの記事IDです。新規投稿の際はIDは存在していないため空白であり、記事の更新の場合はIDが存在しているため必須になります。
|title|必須|記事のタイトルです。|
|private|必須|記事を全体公開にするか限定投稿にするかです。true/falseの記述のみ受け付け、trueの場合は限定投稿、falseの場合は全体公開になります。
|istweet|任意|記事を新規投稿した際に、ツイートするかどうかです。記事の更新の場合はこの値は無視されます。また、qiitaがtwitterと連携していない場合も無視されます。|
|tags|必須|記事につけるタグです。","区切りで最大5つまで指定することが出来ます。|
---

<br>

# 拡張設定

Preferences : Open user settingsから開くユーザー設定の項目で設定できる内容です。

|設定項目名|内容|
|-|-|
| vscode_qiitaapi.accesstoken | qiitaのアクセストークンを設定します。settings.jsonに記述される値のため、ワークスペースに保存する場合はgit等の扱いに注意する必要があります。|
| vscode_qiitaapi.templateDefault | qiita テンプレートのデフォルト値を設定します。|
| vscode_qiitaapi.templateDelimiter | qiita テンプレートの区切り文字を指定します。後方互換性のために存在しています。|
| vscode_qiitaapi.useCopyInUploadImage | 画像アップロード時に生成されるディレクトリの中身を、ハードリンクではなくコピーを使用して生成する場合はonにします。|
| vscode_qiitaapi.uploadImageBeforePost | 投稿前に画像をアップロードするコマンドを自動で実行する場合はonにします。|
---

<br>

# コマンドの詳細

## qiitaに投稿する

- 現在のアクティブファイルを、qiitaに投稿もしくは記事を更新します。

- Markdown(.md)以外の拡張子から投稿する場合は、Pandocのインストールが必要です。

- qiitaのアクセストークンが必要です。
   - qiitaの設定→アプリケーション→個人用アクセストークン→新しくトークンを発行する
    を選択し、スコープに「read_qiita」「write_qiita」をオンにした上で発行し、表示されたアクセストークンを、拡張設定の「vscode_qiitaapi.accesstoken」に設定してください。

<br>

## 画像をアップロードする(beta)

Markdown上に存在する`![代替テキスト](url)`で、urlがローカル画像の(http(s)://から始まらない)ものを、
まとめてアップロードすることができます。

### 使い方

1. 対象となるMarkdownファイルと同じディレクトリに「uploadImages」という名前のディレクトリ名がないことを確認します。
2. 「qiita 画像をアップロードする」を実行します。
3. 「 https://qiita.com/settings/uploading_images 」および「uploadImages」ディレクトリが開きます。
4. 「uploadImages」ディレクトリにある画像を、qiitaにコピー&ペーストします。
5. qiita側の「画像アドレスを一括コピー」を押し、vscode側の上部に表示される入力フォームに貼り付けます。
6. 該当する画像のurlが、全て置き換わります。

### 注意点

- markdown以外のファイルからは使用できません。
- `代替テキスト`を元に、画像のurlを置き換えます。そのため、代替テキストが同じで、異なるurlを持つ画像が存在する場合、置き換えが正しく行われない可能性があります。
- 「uploadImages」に作成されるファイルは、デフォルトは元のファイルからハードリンクされたものになります。端末によっては、意図しない動作になることがありますので、その場合は、`useCopyInUploadImage`をtrueに設定してください。

<br>

# 既知の問題点

- なし

<br>

# 予定

※追加は未定です。使う人次第で増やしたいなとも思っている項目

- IDから投稿記事のダウンロード

- タグ候補の表示

<br>

# リリースノート

## 0.6.0

### 新規機能

- 画像アップロード機能の追加(beta)

### 修正機能

- templateのスペルミスを修正
    - 拡張設定で既に設定されているものは、アップデート時に自動的に修正されます。
    - 「v0.6.0にアップデートしました」という通知が表示されるまでに設定画面を開くと、初期化されているように見えます。
- 初回起動時にも関わらず、アップデート通知が表示される不具合を修正

### 変更機能

- qiita テンプレートを囲む文字のデフォルトを`---`(水平線)に変更

### その他

- ライブラリのアップデート


## 0.5.0

### 新規機能

- qiita テンプレートを囲む文字を`//**********`(コメント)の他に`---`(水平線)を追加。
現在のデフォルトはコメント型ですが、近い将来のアップデートで水平線になります。そのため、この先もコメント型を使用する場合は、setting.jsonで明示的にコメントを指定する必要があります。

### その他

- ライブラリのアップデート

## 過去のリリースノート

- 過去のリリースノートは、[CHANGELOG.md](CHANGELOG.md)を参照してください。
